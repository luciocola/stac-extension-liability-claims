@prefix ceosard: <https://ceos.org/ard/ontology#> .
@prefix iso19157: <https://def.isotc211.org/iso19157/-3/dqm/1.0/> .
@prefix dqv: <http://www.w3.org/ns/dqv#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dcat: <http://www.w3.org/ns/dcat#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix schema: <http://schema.org/> .

# CEOS-ARD Optical Product Example (Sentinel-2 Surface Reflectance)
# Automatically generated from JSON-LD context using the enhanced liability claims extension

<https://example.com/stac/items/S2A_MSIL2A_20231115T101031_N0509_R022_T32TQM_20231115T143408>
  a ceosard:SurfaceReflectanceProduct ;
  
  # CEOS-ARD Certification
  ceosard:productType "optical"^^xsd:string ;
  ceosard:productFamilySpecification ceosard:SR ;
  ceosard:specificationVersion "5.0.1"^^xsd:string ;
  
  # Queryable ARD Quality Metrics (flattened from ISO 19157)
  ceosard:conformsToSpecification true ;
  ceosard:thresholdRequirementsStatus "all"^^xsd:string ;
  ceosard:targetRequirementsAchievement "95.0"^^xsd:decimal ;
  ceosard:cloudCoveragePercentage "15.2"^^xsd:decimal ;
  
  # Geometric Accuracy (ISO 19157 DQ_AbsoluteExternalPositionalAccuracy)
  iso19157:DQ_AbsoluteExternalPositionalAccuracy "12.5"^^xsd:decimal ;
  iso19157:valueUnit "meter"^^xsd:string ;
  iso19157:measureDescription "rRMSE"^^xsd:string ;
  
  # Radiometric Accuracy (ISO 19157 DQ_ThematicClassificationCorrectness)
  iso19157:DQ_ThematicClassificationCorrectness "5.0"^^xsd:decimal ;
  
  # W3C DQV Quality Measurement (comprehensive quality metadata)
  dqv:hasQualityMeasurement [
    a dqv:QualityMeasurement ;
    dqv:inCategory iso19157:PositionalAccuracy ;
    dqv:isMeasurementOf iso19157:Measure28 ;
    dqv:value "12.5"^^xsd:decimal ;
    iso19157:valueUnit "meter"^^xsd:string ;
    dqv:computedOn [
      iso19157:evaluationMethodType "indirect"^^xsd:string ;
      iso19157:evaluationMethodDescription "Geometric accuracy assessed using Ground Control Points (GCPs) across multiple tiles"^^xsd:string
    ]
  ] ;
  
  dqv:hasQualityMeasurement [
    a dqv:QualityMeasurement ;
    dqv:inCategory iso19157:ThematicQuality ;
    dqv:value "5.0"^^xsd:decimal ;
    iso19157:valueUnit "percentage"^^xsd:string ;
    dqv:computedOn [
      iso19157:evaluationMethodType "indirect"^^xsd:string ;
      iso19157:evaluationMethodDescription "Surface reflectance uncertainty from atmospheric correction validation"^^xsd:string
    ]
  ] ;
  
  # Provenance (W3C PROV)
  prov:wasGeneratedBy [
    a prov:Activity , ceosard:ARDQualityValidation ;
    prov:startedAtTime "2023-11-15T14:34:08Z"^^xsd:dateTime ;
    prov:wasAssociatedWith [
      a prov:Agent ;
      schema:name "European Space Agency Copernicus Ground Segment"^^xsd:string
    ]
  ] ;
  
  prov:wasDerivedFrom [
    a prov:Entity , ceosard:SurfaceReflectance ;
    ceosard:productFamilySpecification ceosard:SR ;
    ceosard:specificationVersion "5.0.1"^^xsd:string
  ] .

# SPARQL Query Examples for Semantic Discovery

# Query 1: Find ARD products with geometric accuracy better than 15 meters
# SELECT ?product ?accuracy ?unit
# WHERE {
#   ?product iso19157:DQ_AbsoluteExternalPositionalAccuracy ?accuracy ;
#            iso19157:valueUnit ?unit ;
#            ceosard:conformsToSpecification true .
#   FILTER(?accuracy <= 15)
# }

# Query 2: Find optical ARD products with low cloud coverage and high target compliance
# SELECT ?product ?cloudCoverage ?compliance
# WHERE {
#   ?product ceosard:productType "optical" ;
#            ceosard:cloudCoveragePercentage ?cloudCoverage ;
#            ceosard:targetRequirementsAchievement ?compliance ;
#            ceosard:conformsToSpecification true .
#   FILTER(?cloudCoverage < 20 && ?compliance > 90)
# }

# Query 3: Find products with high metaquality confidence
# SELECT ?product ?confidence
# WHERE {
#   ?product dqv:hasQualityMeasurement ?measurement .
#   ?measurement dqv:inCategory iso19157:Metaquality ;
#                dqv:value ?confidence .
#   FILTER(?confidence > 0.90)
# }

# Query 4: Provenance chain - find products generated by specific processing activity
# SELECT ?product ?activity ?timestamp
# WHERE {
#   ?product prov:wasGeneratedBy ?activity .
#   ?activity a ceosard:ARDQualityValidation ;
#             prov:startedAtTime ?timestamp .
# }
